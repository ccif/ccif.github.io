---
import { getCollection } from 'astro:content';
import { Icon } from 'astro-icon/components';

const resumeEntries = await getCollection('resume');
const resumeData = resumeEntries[0]?.data;

if (!resumeData) {
  throw new Error('Resume data not found');
}

const { name, contact, experience, projects, skills, education } = resumeData;
---

<ul class="timeline timeline-vertical timeline-compact timeline-snap-icon p-4">
  {experience.map((exp: any, index: number) => (
    <li>
      {index > 0 && <hr />}
      <div class="timeline-start font-mono text-sm pl-1">
        <time>{exp.dates.split(' â€“ ')[0]}</time>
      </div>
      <div class="timeline-middle">
        <Icon name="solar:suitcase-line-duotone" class="h-5 w-5" />
      </div>
      <div class="timeline-end">
        <div class="flex flex-col space-y-1 p-2">
        <time class="font-bold">{exp.title}</time>
        <span class="inline-flex items-center space-x-1">
          <Icon name="solar:buildings-line-duotone" class="h-5 w-5" />
          {exp.company}
        </span>
        <span class="inline-flex items-center space-x-1">
          <Icon name="solar:point-on-map-line-duotone" class="h-5 w-5" />
          {exp.location}
        </span></div>
        <ul class="space-y-2 p-2">
          {exp.bullets.slice(0, 2).map((bullet: string) => (
            <li>{bullet}</li>
          ))}
        </ul>
      </div>
      <hr />
    </li>
  ))}
</ul>

<style>
  li {
    --timeline-col-start: auto;
  }

  .timeline-start {
    grid-row: 2;
  }

  .timeline-end {
    grid-row: 3;
  }
</style>
